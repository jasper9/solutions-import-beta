define(["underscore","backbone","util/appDirCommon","model/gitHubFile"],function(_,Backbone,cu,GitHubFile){var GHViewDataModal=Backbone.View.extend({el:"#viewFileModal",initialize:function(options){_.bindAll(this,"handleViewEvent","showModal");if(_.isUndefined(this.model))return;!this.model instanceof GitHubFile&&alert("GHViewDataModal requires a GitHubFile instance"),this.options=_.extend({},{showModal:!0,requestOptions:{reset:!1,success:_.bind(function(model,response,jqXHR){cu.log("GHViewDataModal Retrieved data successfully"),this.showModal(model.get("path"),model.get("rawData"))},this)}},options),_.isUndefined(this.options.clickTarget)||$(this.options.clickTarget).on("click",_.bind(function(e){this.handleViewEvent(e)},this))},handleViewEvent:function(e){e.preventDefault();var rawData=this.model.get("rawData");if(_.isUndefined(rawData)){this.model.fetch(this.options.requestOptions);return}this.showModal(this.model.get("path"),this.model.get("rawData"))},showModal:function(header,data){this.$("#model-content").empty().append(_.escape(data)),this.$("h3").empty().text(header);var url=this.model.get("inMemLink");this.$("a[download]",".modal-footer").attr("href",url).attr("download",header).attr("target","_blank"),this.options.showModal?this.$el.modal({backdrop:!0,keyboard:!0}):this.$("a[download]",".modal-footer")[0].click()}});return GHViewDataModal});